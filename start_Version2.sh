#!/bin/bash

set -e

echo "--------------------------"
echo "๐ ุฌุงุฑู ุชุซุจูุช ุฌููุน ุงูุงุนุชูุงุฏูุงุช..."
echo "--------------------------"

# ุชุซุจูุช ุงุนุชูุงุฏุงุช ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
if [ -d "client" ]; then
  echo "โ ุชุซุจูุช ุงุนุชูุงุฏุงุช client..."
  cd client && npm install
  cd ..
fi

# ุชุซุจูุช ุงุนุชูุงุฏุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ
if [ -d "server" ]; then
  echo "โ ุชุซุจูุช ุงุนุชูุงุฏุงุช server..."
  cd server && npm install
  cd ..
fi

# ุชุซุจูุช ุงุนุชูุงุฏุงุช ุงูุจูููุดูู ุฅุฐุง ูุงู ููุฌูุฏ
if [ -d "blockchain" ]; then
  echo "โ ุชุซุจูุช ุงุนุชูุงุฏุงุช blockchain..."
  cd blockchain && npm install
  cd ..
fi

echo "--------------------------"
echo "๐ ุจุฏุก ุชุดุบูู ุฌููุน ุงูุฎุฏูุงุช ุชููุงุฆูุงู..."
echo "--------------------------"

# ุชุดุบูู ุงูุจูููุดูู ุงููุญูู ุฅุฐุง ูุงู ููุฌูุฏ
if [ -d "blockchain" ]; then
  echo "๐ ุชุดุบูู node ุงูุจูููุดูู ูู ุงูุฎูููุฉ..."
  (cd blockchain && npx hardhat node > ../blockchain.log 2>&1 &)
  sleep 5
fi

# ุชุดุบูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูู ุงูุฎูููุฉ
if [ -d "server" ]; then
  echo "๐ ุชุดุบูู backend (server) ูู ุงูุฎูููุฉ..."
  (cd server && npm start > ../server.log 2>&1 &)
  sleep 5
fi

# ุชุดุบูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูู ุงูุฎูููุฉ
if [ -d "client" ]; then
  echo "๐ ุชุดุบูู frontend (client) ูู ุงูุฎูููุฉ..."
  (cd client && npm start > ../client.log 2>&1 &)
  sleep 5
fi

echo ""
echo "โ ุชู ุชุดุบูู ูู ุดูุก! ููููู ุงูุขู ูุชุญ ุงููุชุตูุญ ุนูู ุงูุฑุงุจุท ุงูุฐู ูุธูุฑ ูู ุงูุทุฑููุฉ (ุบุงูุจูุง http://localhost:3000)"
echo "๐ ูุฎุฑุฌุงุช ูู ุฎุฏูุฉ ูุญููุธุฉ ูู ูููุงุช blockchain.log ู server.log ู client.log"
echo "--------------------------"